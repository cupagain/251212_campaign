<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é›™ 12 ç›´æ’­ç‹‚æ­¡ | Double 12 Live Carnival</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&family=Roboto:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-deep: #050505;
            --bg-panel: #141416;
            
            --accent: #00d2be;
            
            /* é‡‘è‰²æ¼¸å±¤åƒè€ƒè‰² */
            --gold-start: #bf953f;
            --gold-mid: #fcf6ba;
            --gold-end: #b38728;
            
            --text-main: #ffffff;
            --text-sub: #d0d0d0;
            --border-color: rgba(255, 255, 255, 0.15);

            --row-height: 60px;
            
            --font-stack: 'Roboto', 'Noto Sans TC', sans-serif;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: var(--font-stack);
            background-color: var(--bg-deep);
            color: var(--text-main);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            padding: 40px 15px;
            background-image: 
                radial-gradient(circle at 50% 0%, rgba(0, 210, 190, 0.1) 0%, transparent 60%),
                linear-gradient(180deg, rgba(20,20,20,0) 0%, rgba(0,0,0,1) 100%);
            -webkit-font-smoothing: antialiased;
        }

        .container {
            width: 100%;
            max-width: 900px;
            position: relative;
            z-index: 2;
        }

        /* --- Diamond Styling --- */
        .val-wrapper {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
        }

        .d-emoji {
            font-family: "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
            margin-left: 6px;
            line-height: 1;
            transform: translateZ(0); 
            display: inline-block;
            vertical-align: baseline;
            -webkit-text-fill-color: initial; 
            text-shadow: none;
        }

        /* é’è‰²é‘½çŸ³ (#00d2be) */
        .d-cyan {
            filter: sepia(100%) hue-rotate(125deg) saturate(350%) brightness(1.1) drop-shadow(0 0 5px rgba(0, 210, 190, 0.4));
        }

        /* 
           é‡‘è‰²é‘½çŸ³æ¿¾é¡ (ä¿®æ­£ç‰ˆ)
           èª¿æ•´ç‚ºæ›´æ¥è¿‘æ–‡å­—æ¼¸å±¤çš„é»ƒé‡‘è‰²ï¼Œè€Œéæ·±æ©˜è‰²
        */
        .d-gold {
            filter: brightness(0) saturate(100%) invert(83%) sepia(28%) saturate(1063%) hue-rotate(350deg) brightness(102%) contrast(104%) drop-shadow(0 0 8px rgba(252, 246, 186, 0.6));
        }

        /* å°ºå¯¸è¨­å®š */
        .d-sm { font-size: 0.9em; position: relative; top: -1px; } 
        .d-md { font-size: 0.85em; position: relative; top: -1px; } 
        .d-lg { font-size: 0.75em; margin-left: 10px; position: relative; top: -2px; } 
        
        /* Hero ç”¨ï¼šè¨­ç‚º 0.85emï¼Œç¢ºä¿è·Ÿ 550,000 å°é½Šä¸”å¤§å°ä¸€è‡´ */
        .d-xl { 
            font-size: 0.85em; 
            margin-left: 8px; 
            position: relative; 
            top: 0; /* Flexbox æœƒè™•ç†å°é½Šï¼Œé‡ç½® top */
        }

        /* --- Language Switcher --- */
        .lang-switch {
            display: flex;
            justify-content: flex-end;
            gap: 8px;
            margin-bottom: 30px;
        }

        .lang-btn {
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border-color);
            color: #ccc;
            padding: 6px 16px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.3s;
        }

        .lang-btn.active {
            background: var(--accent);
            border-color: var(--accent);
            color: #000;
            font-weight: 700;
        }

        /* --- Hero Section --- */
        .hero {
            text-align: center;
            margin-bottom: 50px;
        }

        .date-badge {
            color: var(--accent);
            font-size: 1rem;
            letter-spacing: 2px;
            margin-bottom: 15px;
            font-weight: 700;
            text-shadow: 0 0 10px rgba(0, 210, 190, 0.4);
        }

        h1 {
            font-size: 3.5rem;
            font-weight: 900;
            margin-bottom: 25px;
            font-style: italic;
            text-transform: uppercase;
            color: #fff;
            text-shadow: 0 0 30px rgba(255,255,255,0.3);
            white-space: nowrap; /* ç›¡é‡ä¸æ›è¡Œ */
        }

        /* æ‰‹æ©Ÿç‰ˆå­—é«”èª¿æ•´ï¼šé˜²æ­¢æ–·è¡Œ */
        @media (max-width: 480px) {
            h1 {
                font-size: 2.2rem; /* ç¸®å°å­—é«”ä»¥é©æ‡‰æ‰‹æ©Ÿè¢å¹• */
                white-space: normal; /* å…è¨±æ›è¡Œï¼Œä½†å­—é«”å¤ å°æ‡‰è©²ä¸æœƒæ–·å¾—é›£çœ‹ */
            }
        }

        .marketing-box {
            margin-bottom: 15px;
        }

        .campaign-tag {
            display: inline-block;
            background: linear-gradient(90deg, transparent, rgba(0, 210, 190, 0.15), transparent);
            border-top: 1px solid var(--accent);
            border-bottom: 1px solid var(--accent);
            color: #fff;
            padding: 8px 30px;
            font-size: 1.2rem;
            font-weight: 700;
            letter-spacing: 2px;
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .campaign-highlight {
            font-size: 1.3rem;
            font-weight: 500;
            line-height: 1.5;
            color: #eee;
        }

        /* é‡‘è‰²æ–‡å­—å®¹å™¨ï¼šä½¿ç”¨ Flexbox å¼·åˆ¶å°é½Š */
        .gold-row {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 5px;
        }

        .gold-text {
            font-size: 2.6rem;
            font-weight: 900;
            background: linear-gradient(to right, var(--gold-start), var(--gold-mid), var(--gold-end));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 20px rgba(252, 246, 186, 0.2);
            white-space: nowrap;
        }
        
        @media (max-width: 480px) {
            .gold-text { font-size: 2.2rem; }
        }

        .cta-btn {
            display: inline-block;
            background: var(--accent);
            color: #000;
            font-size: 1.2rem;
            font-weight: 900;
            padding: 16px 48px;
            border-radius: 50px;
            text-decoration: none;
            box-shadow: 0 0 30px rgba(0, 210, 190, 0.3);
            transition: all 0.2s;
            margin-top: 5px;
            -webkit-font-smoothing: antialiased;
        }

        .cta-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 50px rgba(0, 210, 190, 0.5);
            background: #fff;
        }

        /* --- Dashboard --- */
        .dashboard {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 60px;
        }

        .dash-card {
            background: var(--bg-panel);
            border: 1px solid var(--border-color);
            padding: 30px;
            flex: 1;
            min-width: 300px;
            position: relative;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }
        
        .dash-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; width: 100%; height: 2px;
            background: linear-gradient(90deg, transparent, var(--accent), transparent);
        }

        /* Left Card */
        .dash-left {
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 30px;
        }

        .stats-block {
            text-align: center;
            width: 100%;
        }

        .stats-label {
            color: var(--text-sub);
            font-size: 1rem;
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 500;
        }

        .stats-val {
            line-height: 1;
            font-weight: 900;
            color: #fff;
            text-shadow: 0 5px 15px rgba(0,0,0,0.5);
            font-family: 'Roboto', sans-serif;
            justify-content: center;
        }

        .stats-val.rank-text { font-size: 3.5rem; color: var(--accent); }
        
        .stats-val.total-text { 
            font-size: 2.5rem; 
            color: #fff; 
        }

        .divider {
            width: 60%;
            height: 1px;
            background: rgba(255,255,255,0.1);
            margin: 0 auto;
        }

        /* Right Card */
        .detail-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255,255,255,0.08);
        }
        .detail-row:last-child { border-bottom: none; }
        
        .d-label { 
            color: var(--text-sub); 
            font-size: 1rem; 
            font-weight: 500;
        }
        
        .d-val { 
            color: #fff; 
            font-weight: 700; 
            font-size: 1.3rem; 
            font-family: 'Roboto', sans-serif; 
            justify-content: flex-end; 
        }

        /* --- Split Layout --- */
        .split-header {
            display: grid;
            grid-template-columns: 1fr 1fr;
            margin-bottom: 0;
        }
        
        .col-header {
            background: #1a1a1d;
            padding: 20px;
            color: #fff;
            font-weight: 700;
            text-align: center;
            border-top: 3px solid var(--accent);
            font-size: 1.2rem;
            letter-spacing: 1px;
        }

        .split-body {
            display: grid;
            grid-template-columns: 1fr 1fr;
            background: var(--bg-panel);
            border: 1px solid var(--border-color);
            border-top: none;
        }

        /* æ‰‹æ©Ÿç‰ˆï¼šä¿æŒå…©æ¬„ä¸¦æ’ */
        @media (max-width: 768px) {
            /* å„€è¡¨æ¿ä¿æŒå †ç–Š (å› ç‚ºå…§å®¹å¤š) */
            .dashboard { flex-direction: column; }
            .dash-card { min-width: auto; }

            /* æ’è¡Œæ¦œèˆ‡çå‹µï¼šä¿æŒå·¦å³å…©æ¬„ (1fr 1fr) */
            .split-header, .split-body { grid-template-columns: 1fr 1fr; }
            
            /* èª¿æ•´æ‰‹æ©Ÿç‰ˆå…§è·èˆ‡å­—é«”ï¼Œé¿å…éæ“  */
            .col-header { 
                padding: 15px 5px; 
                font-size: 1rem; 
            }
            .align-row { 
                padding: 0 10px; 
                font-size: 0.95rem; 
            }
            
            /* éš±è—éé•·çš„æ’åæ–‡å­—ï¼Œç”¨æ•¸å­—å°±å¥½ (å¯é¸) */
            .lb-rank { margin-right: 5px; }
            
            /* é‘½çŸ³ç¸®å°ä¸€é» */
            .d-sm { font-size: 0.8em; }
        }

        .align-row {
            height: var(--row-height);
            display: flex;
            align-items: center;
            padding: 0 25px;
            border-bottom: 1px solid var(--border-color);
            font-size: 1.1rem;
        }
        
        .align-row:last-child { border-bottom: none; }

        .lb-col { border-right: 1px solid var(--border-color); }
        .lb-rank { width: 50px; font-weight: 900; color: #666; font-style: italic; font-size: 1.2rem; }
        
        .lb-score { 
            margin-left: auto; 
            color: #fff; 
            font-weight: 700; 
            font-family: 'Roboto', sans-serif;
            display: flex;
            align-items: center;
        }
        
        .rank-1 { color: var(--gold-mid); text-shadow: 0 0 10px rgba(255, 215, 0, 0.4); font-size: 1.4rem; }
        .rank-2 { color: #e0e0e0; text-shadow: 0 0 10px rgba(255, 255, 255, 0.4); font-size: 1.4rem; }
        .rank-3 { color: #d4a58e; text-shadow: 0 0 10px rgba(212, 165, 142, 0.4); font-size: 1.4rem; }

        .r-val { 
            width: 100%; 
            display: flex;
            align-items: center;
            justify-content: flex-end; 
            color: var(--accent); 
            font-weight: 700; 
            font-family: 'Roboto', sans-serif; 
            letter-spacing: 0.5px;
        }

        /* --- Rules --- */
        .rules-section {
            margin-top: 60px;
            padding: 30px;
            background: rgba(255,255,255,0.03);
            border-radius: 10px;
            color: #ccc;
        }
        .rules-title { font-weight: 700; color: #fff; margin-bottom: 20px; font-size: 1.2rem; border-left: 3px solid var(--accent); padding-left: 10px;}
        .rules-list {
            list-style: none;
            padding-left: 0;
        }
        .rules-list li {
            margin-bottom: 12px;
            line-height: 1.6;
            font-size: 1rem;
            padding-left: 20px;
            position: relative;
        }
        /* ç¶ è‰²åœ“é» */
        .rules-list li::before {
            content: 'â€¢';
            position: absolute;
            left: 0;
            top: 0;
            color: var(--accent);
            font-size: 1.5rem;
            line-height: 1.5rem;
        }

        .error-msg {
            text-align: center;
            padding: 15px;
            background: rgba(255, 50, 50, 0.15);
            color: #ff8080;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 50, 50, 0.3);
            border-radius: 8px;
        }
        .hidden { display: none; }
    </style>
</head>
<body>

    <div class="container">
        <!-- Language -->
        <div class="lang-switch">
            <button class="lang-btn active" onclick="setLang('tc')">ç¹é«”</button>
            <button class="lang-btn" onclick="setLang('sc')">ç®€ä½“</button>
            <button class="lang-btn" onclick="setLang('en')">EN</button>
            <button class="lang-btn" onclick="setLang('jp')">æ—¥æœ¬èª</button>
        </div>

        <!-- Hero -->
        <div class="hero">
            <div class="date-badge" data-i18n="date">12/12 - 12/17</div>
            <h1 data-i18n="title">é›™ 12 ç›´æ’­ç‹‚æ­¡</h1>
            
            <div class="marketing-box">
                <div class="campaign-tag" data-i18n="subtitle">ç›´æ’­è€—é‘½æ’è¡Œæ¦œ</div>
                <div class="campaign-highlight">
                    <span data-i18n="desc_prefix">æ‡‰æ´äººæ°£å¥³ç¥å¥ªå¤§çï¼Œå‰ååç“œåˆ†ç¸½è¨ˆ</span><br>
                    
                    <div class="gold-row">
                        <!-- é‡‘è‰²æ–‡å­— -->
                        <span class="gold-text">550,000</span>
                        <!-- é‡‘è‰²é‘½çŸ³ Emoji (Filter Adjusted) -->
                        <span class="d-emoji d-xl d-gold">ğŸ’</span>
                    </div>
                </div>
            </div>
            
            <div>
                <a href="#" class="cta-btn" data-i18n="cta">æŸ¥çœ‹äººæ°£å¥³ç¥æ´»å‹•</a>
            </div>
        </div>

        <!-- Error Msg -->
        <div id="error-msg" class="error-msg hidden">
            <span data-i18n="error_desc">è®€å–å¤±æ•—</span> <span id="debug-text" style="font-size:0.8em; opacity: 0.8;"></span>
        </div>

        <!-- Dashboard (Symmetrical) -->
        <div id="stats-content" class="dashboard">
            <!-- Left Card: Rank & Total -->
            <div class="dash-card dash-left">
                <!-- Rank Block -->
                <div class="stats-block">
                    <div class="stats-label" data-i18n="current_rank">ç•¶å‰æ’å</div>
                    <div class="stats-val rank-text" id="disp-rank">--</div>
                </div>
                
                <div class="divider"></div>

                <!-- Total Block -->
                <div class="stats-block">
                    <div class="stats-label" data-i18n="total_spent">ç¸½æ¶ˆè²»</div>
                    <div class="stats-val total-text val-wrapper">
                        <span id="disp-total">0</span>
                        <!-- ç¸®å°å¾Œçš„é’è‰²é‘½çŸ³ (0.75em) -->
                        <span class="d-emoji d-lg d-cyan">ğŸ’</span>
                    </div>
                </div>
            </div>

            <!-- Right Card: Details -->
            <div class="dash-card dash-right">
                <div class="detail-row">
                    <span class="d-label" data-i18n="breakdown_gift">ç›´æ’­ç¦®ç‰©</span>
                    <div class="d-val val-wrapper">
                        <span id="disp-gift">0</span>
                        <span class="d-emoji d-md d-cyan">ğŸ’</span>
                    </div>
                </div>
                <div class="detail-row">
                    <span class="d-label" data-i18n="breakdown_ticket">é™æ™‚è¡¨æ¼”</span>
                    <div class="d-val val-wrapper">
                        <span id="disp-ticket">0</span>
                        <span class="d-emoji d-md d-cyan">ğŸ’</span>
                    </div>
                </div>
                <div class="detail-row">
                    <span class="d-label" data-i18n="breakdown_menu">æŒ‘é€—è¡¨æ¼”</span>
                    <div class="d-val val-wrapper">
                        <span id="disp-command">0</span>
                        <span class="d-emoji d-md d-cyan">ğŸ’</span>
                    </div>
                </div>
                <div class="detail-row">
                    <span class="d-label" data-i18n="breakdown_lovense">éœ‡å‹•æ§åˆ¶</span>
                    <div class="d-val val-wrapper">
                        <span id="disp-lovense">0</span>
                        <span class="d-emoji d-md d-cyan">ğŸ’</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Aligned Leaderboard & Rewards -->
        <div class="split-header">
            <div class="col-header" data-i18n="lb_title">ç¸½é‘½æ’è¡Œæ¦œ</div>
            <div class="col-header" data-i18n="rewards_title">æ’åçå‹µ</div>
        </div>
        <div class="split-body">
            <!-- Left: Leaderboard -->
            <div class="lb-col" id="leaderboard-body">
                <!-- JS Generated -->
            </div>

            <!-- Right: Rewards -->
            <div class="reward-col" id="rewards-body">
                <!-- JS Generated -->
            </div>
        </div>

        <!-- Rules -->
        <div class="rules-section">
            <div class="rules-title" data-i18n="rules_title">æ´»å‹•èªªæ˜</div>
            <ul class="rules-list" id="rules-list"></ul>
        </div>
    </div>

    <script>
        const API_BASE_URL = "https://swag-campaign-api-388277274438.asia-east1.run.app"; 
        
        // é‘½çŸ³ Emoji HTML (åŒ…å«é’è‰²æ¿¾é¡)
        const DIAMOND_HTML = '<span class="d-emoji d-sm d-cyan">ğŸ’</span>';

        const TRANSLATIONS = {
            tc: {
                date: "12/12 00:00 - 12/17 23:59 (GMT+8)",
                title: "é›™ 12 ç›´æ’­ç‹‚æ­¡",
                subtitle: "ç›´æ’­è€—é‘½æ’è¡Œæ¦œ",
                desc_prefix: "æ‡‰æ´äººæ°£å¥³ç¥å¥ªå¤§çï¼Œå‰ååç“œåˆ†ç¸½è¨ˆ",
                cta: "æŸ¥çœ‹äººæ°£å¥³ç¥æ´»å‹•",
                current_rank: "ç•¶å‰æ’å",
                total_spent: "ç¸½æ¶ˆè²»",
                error_desc: "è®€å–å¤±æ•—ï¼Œè«‹ç¢ºèªå·²ç™»å…¥ã€‚",
                lb_title: "ç¸½é‘½æ’è¡Œæ¦œ",
                rewards_title: "æ’åçå‹µ",
                breakdown_gift: "ç›´æ’­ç¦®ç‰©",
                breakdown_ticket: "é™æ™‚è¡¨æ¼”",
                breakdown_menu: "æŒ‘é€—è¡¨æ¼”",
                breakdown_lovense: "éœ‡å‹•æ§åˆ¶",
                rules_title: "æ´»å‹•èªªæ˜",
                rules_list: [
                    "ç›´æ’­é–“ç¸½é‘½çŸ³åƒ…è¨ˆç®—ï¼šã€Œç›´æ’­ç¦®ç‰©ã€ã€ã€Œé™æ™‚è¡¨æ¼”ç¥¨åˆ¸ã€ã€ã€ŒæŒ‘é€—è¡¨æ¼”ã€ã€‚",
                    "æ’è¡Œæ¦œé‘½çŸ³ç›¸åŒè€…ï¼Œä»¥å…ˆé”æˆè€…æ’ååœ¨å‰ã€‚",
                    "æ’åé‘½çŸ³çå‹µå°‡æ–¼æ´»å‹•çµæŸå¾Œ 3 å€‹å·¥ä½œå¤©å…§æ´¾ç™¼ã€‚",
                    "è³‡æ–™éœ€ç™»å…¥å¸³è™Ÿä»¥æ­£ç¢ºé¡¯ç¤ºã€‚",
                    "æœ€çµ‚çµæœä»¥å®˜æ–¹è¨ˆç®—ç‚ºæº–ã€‚"
                ]
            },
            sc: {
                date: "12/12 00:00 - 12/17 23:59 (GMT+8)",
                title: "åŒ 12 ç›´æ’­ç‹‚æ¬¢",
                subtitle: "ç›´æ’­è€—é’»æ’è¡Œæ¦œ",
                desc_prefix: "åº”æ´äººæ°”å¥³ç¥å¤ºå¤§å¥–ï¼Œå‰ååç“œåˆ†æ€»è®¡",
                cta: "æŸ¥çœ‹äººæ°”å¥³ç¥æ´»åŠ¨",
                current_rank: "å½“å‰æ’å",
                total_spent: "æ€»æ¶ˆè´¹",
                error_desc: "è¯»å–å¤±è´¥ï¼Œè¯·ç¡®è®¤å·²ç™»å½•ã€‚",
                lb_title: "æ€»é’»æ’è¡Œæ¦œ",
                rewards_title: "æ’åå¥–åŠ±",
                breakdown_gift: "ç›´æ’­ç¤¼ç‰©",
                breakdown_ticket: "é™æ—¶è¡¨æ¼”",
                breakdown_menu: "æŒ‘é€—è¡¨æ¼”",
                breakdown_lovense: "éœ‡åŠ¨æ§åˆ¶",
                rules_title: "æ´»åŠ¨è¯´æ˜",
                rules_list: [
                    "ç›´æ’­é—´æ€»é’»çŸ³ä»…è®¡ç®—ï¼šâ€œç›´æ’­ç¤¼ç‰©â€ï¼Œâ€œé™æ—¶è¡¨æ¼”ç¥¨åˆ¸â€ï¼Œâ€œæŒ‘é€—è¡¨æ¼”â€ã€‚",
                    "æ’è¡Œæ¦œé’»çŸ³ç›¸åŒè€…ï¼Œä»¥å…ˆè¾¾æˆè€…æ’ååœ¨å‰ã€‚",
                    "æ’åé’»çŸ³å¥–åŠ±å°†äºæ´»åŠ¨ç»“æŸå 3 ä¸ªå·¥ä½œå¤©å†…æ´¾å‘ã€‚",
                    "èµ„æ–™éœ€ç™»å…¥å¸å·ä»¥æ­£ç¡®æ˜¾ç¤ºã€‚",
                    "æœ€ç»ˆç»“æœä»¥å®˜æ–¹è®¡ç®—ä¸ºå‡†ã€‚"
                ]
            },
            en: {
                date: "Dec 12 - Dec 17 (GMT+8)",
                title: "Double 12 Carnival",
                subtitle: "Diamond Spending Leaderboard",
                desc_prefix: "Support Goddesses & Win Big! Share total",
                cta: "View Event",
                current_rank: "Rank",
                total_spent: "Total",
                error_desc: "Load failed. Please log in.",
                lb_title: "Total Diamond Leaderboard",
                rewards_title: "Rewards",
                breakdown_gift: "Gifts",
                breakdown_ticket: "Tickets",
                breakdown_menu: "Show",
                breakdown_lovense: "Lovense",
                rules_title: "Rules",
                rules_list: [
                    "Total diamonds calculated from: 'Live Gifts', 'Show Tickets', 'Shows' only.",
                    "If diamonds are equal, the first to achieve the amount ranks higher.",
                    "Rewards distributed within 3 working days after event ends.",
                    "Login required to view personal stats.",
                    "Official calculation results are final."
                ]
            },
            jp: {
                date: "12/12 - 12/17 (GMT+8)",
                title: "ãƒ€ãƒ–ãƒ«12 ã‚«ãƒ¼ãƒ‹ãƒãƒ«",
                subtitle: "ãƒ€ã‚¤ãƒ¤æ¶ˆè²»ãƒ©ãƒ³ã‚­ãƒ³ã‚°",
                desc_prefix: "å¥³ç¥ã‚’å¿œæ´ã—ã¦å¤§è³ã‚’ç‹™ãŠã†ï¼ç·é¡",
                cta: "ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¦‹ã‚‹",
                current_rank: "ç¾åœ¨ã®é †ä½",
                total_spent: "åˆè¨ˆæ¶ˆè²»",
                error_desc: "èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚",
                lb_title: "ãƒ©ãƒ³ã‚­ãƒ³ã‚°",
                rewards_title: "ãƒ©ãƒ³ã‚­ãƒ³ã‚°å ±é…¬",
                breakdown_gift: "ã‚®ãƒ•ãƒˆ",
                breakdown_ticket: "ãƒã‚±ãƒƒãƒˆ",
                breakdown_menu: "ã‚·ãƒ§ãƒ¼",
                breakdown_lovense: "Lovense",
                rules_title: "æ³¨æ„äº‹é …",
                rules_list: [
                    "å¯¾è±¡ï¼šã€ãƒ©ã‚¤ãƒ–ã‚®ãƒ•ãƒˆã€ã€ã€ã‚·ãƒ§ãƒ¼ãƒã‚±ãƒƒãƒˆã€ã€ã€ã‚·ãƒ§ãƒ¼ã€ã®ã¿ã€‚",
                    "åŒãƒ€ã‚¤ãƒ¤æ•°ã®å ´åˆã¯ã€å…ˆã«é”æˆã—ãŸæ–¹ãŒä¸Šä½ã¨ãªã‚Šã¾ã™ã€‚",
                    "å ±é…¬ã¯ã‚¤ãƒ™ãƒ³ãƒˆçµ‚äº†å¾Œ3å–¶æ¥­æ—¥ä»¥å†…ã«é…å¸ƒã•ã‚Œã¾ã™ã€‚",
                    "ãƒ‡ãƒ¼ã‚¿è¡¨ç¤ºã«ã¯ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™ã€‚",
                    "æœ€çµ‚çµæœã¯å…¬å¼ã®é›†è¨ˆã«æº–ã˜ã¾ã™ã€‚"
                ]
            }
        };

        const MOCK_LEADERBOARD = [
            { rank: 1, score: 917274 },
            { rank: 2, score: 816167 },
            { rank: 3, score: 591688 },
            { rank: 4, score: 568800 },
            { rank: 5, score: 532795 },
            { rank: 6, score: 499997 },
            { rank: 7, score: 482676 },
            { rank: 8, score: 427947 },
            { rank: 9, score: 397675 },
            { rank: 10, score: 389995 }
        ];

        const REWARDS = [
            100000, 90000, 80000, 70000, 60000, 50000, 40000, 30000, 20000, 10000
        ];

        function setLang(lang) {
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (
                    (lang === 'tc' && btn.innerText.includes('ç¹')) ||
                    (lang === 'sc' && btn.innerText.includes('ç®€')) ||
                    (lang === 'en' && btn.innerText.includes('EN')) ||
                    (lang === 'jp' && btn.innerText.includes('æ—¥'))
                ) {
                    btn.classList.add('active');
                }
            });

            const t = TRANSLATIONS[lang];

            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (t[key]) el.innerHTML = t[key];
            });

            const rulesContainer = document.getElementById('rules-list');
            rulesContainer.innerHTML = '';
            t.rules_list.forEach(rule => {
                const li = document.createElement('li');
                li.textContent = rule;
                rulesContainer.appendChild(li);
            });

            renderAlignedLists();
        }

        function renderAlignedLists() {
            // Render Leaderboard (Left)
            const lbBody = document.getElementById('leaderboard-body');
            lbBody.innerHTML = '';
            MOCK_LEADERBOARD.forEach(item => {
                let rankClass = '';
                if(item.rank === 1) rankClass = 'rank-1';
                else if(item.rank === 2) rankClass = 'rank-2';
                else if(item.rank === 3) rankClass = 'rank-3';

                const div = document.createElement('div');
                div.className = 'align-row';
                div.innerHTML = `
                    <span class="lb-rank ${rankClass}">${item.rank}</span>
                    <span class="lb-score val-wrapper">${item.score.toLocaleString()} ${DIAMOND_HTML}</span>
                `;
                lbBody.appendChild(div);
            });

            // Render Rewards (Right)
            const rewardsBody = document.getElementById('rewards-body');
            rewardsBody.innerHTML = '';
            REWARDS.forEach((val) => {
                const div = document.createElement('div');
                div.className = 'align-row';
                div.innerHTML = `
                    <div class="r-val val-wrapper">${val.toLocaleString()} ${DIAMOND_HTML}</div>
                `;
                rewardsBody.appendChild(div);
            });
        }

        function getUserId() {
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.has('user_id')) return urlParams.get('user_id');
            if (window.location.hash) {
                const hashParams = new URLSearchParams(window.location.hash.substring(1));
                if (hashParams.has('user_id')) return hashParams.get('user_id');
            }
            const regex = /user_id=([a-fA-F0-9]{24})/;
            const match = window.location.href.match(regex);
            if (match && match[1]) return match[1];
            return null;
        }

        async function fetchUserData() {
            const userId = getUserId();
            const errorEl = document.getElementById('error-msg');
            const debugText = document.getElementById('debug-text');

            if (!userId) return; 

            try {
                const response = await fetch(`${API_BASE_URL}/?user_id=${userId}`, {
                    method: 'GET',
                    credentials: 'omit',
                    headers: { 'Content-Type': 'application/json' }
                });

                if (!response.ok) throw new Error(`${response.status}`);

                const data = await response.json();

                document.getElementById('disp-rank').textContent = data.rank;
                document.getElementById('disp-total').textContent = data.total_diamonds.toLocaleString();
                
                document.getElementById('disp-gift').textContent = data.breakdown.livestream_gift.toLocaleString();
                document.getElementById('disp-ticket').textContent = data.breakdown.show_ticket.toLocaleString();
                document.getElementById('disp-command').textContent = data.breakdown.command.toLocaleString();
                document.getElementById('disp-lovense').textContent = data.breakdown.lovense.toLocaleString();

            } catch (err) {
                console.error(err);
                errorEl.classList.remove('hidden');
                debugText.textContent = `(ID: ${userId})`;
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            setLang('tc');
            fetchUserData();
        });
    </script>
</body>
</html>
